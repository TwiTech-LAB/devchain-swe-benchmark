{
  "instance_id": "django__django-16485",
  "status": "completed",
  "patch": "diff --git a/django/template/defaultfilters.py b/django/template/defaultfilters.py\nindex 23c3a08c67..78881987fc 100644\n--- a/django/template/defaultfilters.py\n+++ b/django/template/defaultfilters.py\n@@ -168,7 +168,7 @@ def floatformat(text, arg=-1):\n     except (ValueError, OverflowError, InvalidOperation):\n         return input_val\n \n-    if not m and p < 0:\n+    if not m and p <= 0:\n         return mark_safe(\n             formats.number_format(\n                 \"%d\" % (int(d)),\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-16T20:19:06.823669",
  "end_time": "2026-01-16T20:22:48.421066",
  "duration_seconds": 221.597397,
  "error_message": null,
  "workspace_path": "./workspaces/django__django-16485",
  "epic_comments": [
    {
      "epic_id": "97751b59-922b-4855-b476-bea82dae73b0",
      "epic_title": "Fix: django__django-16485",
      "comment_id": "912f83c5-94e1-42f4-a07e-74fb2fa1234d",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\nThe `floatformat()` function was crashing with `ValueError: valid range for prec is [1, MAX_PREC]` when called with `'0.00'` or `Decimal('0.00')` and argument `0`.\n\n**Root cause:** When the input has no fractional part (like `0.00`) and the requested precision is exactly `0`, the code path that calculates the `prec` parameter for `Context(prec=prec)` resulted in `prec = 0`, which is invalid (minimum is 1).\n\n**Fix:** Changed the condition at line 171 from `if not m and p < 0:` to `if not m and p <= 0:`. This ensures that when there's no meaningful fractional part (`not m`) and we want 0 or fewer decimal places (`p <= 0`), we return the integer representation directly instead of attempting quantization with an invalid precision.\n\n## Files Modified\n- `django/template/defaultfilters.py`: Changed condition from `p < 0` to `p <= 0` at line 171\n\n## Test Results\n- **Test file:** `tests/template_tests/filter_tests/test_floatformat.py`\n- **Baseline (before fix):** 10 passed, 0 failed, 0 errors\n- **After fix:** 10 passed, 0 failed, 0 errors\n- **Regression check:** No new failures introduced\n\n## Additional Verification\nManually tested the reported bug cases:\n- `floatformat('0.00', 0)` now returns `'0'` (was raising ValueError)\n- `floatformat(Decimal('0.00'), 0)` now returns `'0'` (was raising ValueError)\n\nAdditional edge cases verified:\n- `floatformat('34.00000', 0)` \u2192 `'34'` \u2713\n- `floatformat('1.50', 0)` \u2192 `'2'` \u2713\n- `floatformat('0.50', 0)` \u2192 `'1'` \u2713\n- `floatformat('34.23234', 0)` \u2192 `'34'` \u2713\n- `floatformat('34.00000', 3)` \u2192 `'34.000'` \u2713\n\n## Concerns\nNone. The fix is minimal and directly addresses the regression introduced in commit 08c5a787262c1ae57f6517d4574b54a5fcaad124.",
      "created_at": "2026-01-16T19:22:44.076Z"
    }
  ]
}