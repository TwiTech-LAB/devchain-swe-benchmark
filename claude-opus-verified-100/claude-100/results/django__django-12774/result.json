{
  "instance_id": "django__django-12774",
  "status": "completed",
  "patch": "diff --git a/django/db/models/query.py b/django/db/models/query.py\nindex d9c9b0db04..f22f31a039 100644\n--- a/django/db/models/query.py\n+++ b/django/db/models/query.py\n@@ -689,8 +689,13 @@ class QuerySet:\n         \"\"\"\n         assert not self.query.is_sliced, \\\n             \"Cannot use 'limit' or 'offset' with in_bulk\"\n-        if field_name != 'pk' and not self.model._meta.get_field(field_name).unique:\n-            raise ValueError(\"in_bulk()'s field_name must be a unique field but %r isn't.\" % field_name)\n+        opts = self.model._meta\n+        if field_name != 'pk' and not opts.get_field(field_name).unique:\n+            if not any(\n+                constraint.fields == (field_name,)\n+                for constraint in opts.total_unique_constraints\n+            ):\n+                raise ValueError(\"in_bulk()'s field_name must be a unique field but %r isn't.\" % field_name)\n         if id_list is not None:\n             if not id_list:\n                 return {}\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-17T01:55:32.895463",
  "end_time": "2026-01-17T01:59:15.722539",
  "duration_seconds": 222.827076,
  "error_message": null,
  "workspace_path": "./workspaces/django__django-12774",
  "epic_comments": [
    {
      "epic_id": "1b94b998-e930-48d2-ac0d-6bdef64f04aa",
      "epic_title": "Fix: django__django-12774",
      "comment_id": "9c3ec65f-ac1a-439f-845e-dd7cf9508a4e",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\nModified `QuerySet.in_bulk()` to recognize fields that are unique via `UniqueConstraint` (without condition), not just fields with `unique=True`.\n\nThe issue was that `in_bulk()` only checked `field.unique` attribute, but didn't consider `UniqueConstraint` in `Meta.constraints`. Now it also checks `model._meta.total_unique_constraints` for single-field constraints matching the requested field.\n\n## Files Modified\n- **django/db/models/query.py**: Modified lines 692-698 in the `in_bulk()` method to check for `UniqueConstraint` with a single field and no condition.\n\n## Test Results\n- **Test file:** tests/lookup/tests.py\n- **Baseline (before fix):** 4 passed, 0 failed, 0 errors\n- **After fix:** 4 passed, 0 failed, 0 errors\n- **Regression check:** No new failures introduced\n\nAdditional tests run:\n- constraints tests: 24 passed\n- lookup tests: 48 passed\n\n## Additional Verification\nManual verification confirmed:\n1. \u2705 Single-field `UniqueConstraint` without condition now works with `in_bulk()`\n2. \u2705 Conditional `UniqueConstraint` still correctly raises `ValueError`\n3. \u2705 Multi-field `UniqueConstraint` still correctly raises `ValueError`\n4. \u2705 Non-unique fields still correctly raise `ValueError`\n\n## Concerns\nNone. The fix is minimal and leverages the existing `total_unique_constraints` property which already filters out conditional constraints.",
      "created_at": "2026-01-17T00:59:00.750Z"
    }
  ]
}