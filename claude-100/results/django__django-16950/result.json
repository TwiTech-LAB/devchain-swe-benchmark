{
  "instance_id": "django__django-16950",
  "status": "completed",
  "patch": "diff --git a/django/forms/models.py b/django/forms/models.py\nindex 3fa04b821f..0bc496565b 100644\n--- a/django/forms/models.py\n+++ b/django/forms/models.py\n@@ -1177,7 +1177,7 @@ class BaseInlineFormSet(BaseModelFormSet):\n                 to_field = self.instance._meta.get_field(kwargs[\"to_field\"])\n             else:\n                 to_field = self.instance._meta.pk\n-            if to_field.has_default():\n+            if to_field.has_default() and to_field.primary_key:\n                 setattr(self.instance, to_field.attname, None)\n \n         form.fields[name] = InlineForeignKeyField(self.instance, **kwargs)\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-16T20:20:22.329517",
  "end_time": "2026-01-16T20:26:44.358391",
  "duration_seconds": 382.028874,
  "error_message": null,
  "workspace_path": "./workspaces/django__django-16950",
  "epic_comments": [
    {
      "epic_id": "a5044f00-9a7c-449a-80d5-96f998120452",
      "epic_title": "Fix: django__django-16950",
      "comment_id": "507ae9da-3d78-45ad-a59f-78bfa6cce8f2",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nFixed the bug where Django Admin with Inlines was not respecting UUIDField default values when the ForeignKey uses `to_field` pointing to a non-primary-key field.\n\n**Root Cause**: In `BaseInlineFormSet.add_fields()`, the code was resetting any field with a default to `None` when adding a new object. This logic was intended only for auto-generated primary keys but was incorrectly applied to non-pk fields like UUIDField alternate keys.\n\n**Solution**: Added a check to only reset the field to `None` if it is the primary key (`to_field.primary_key`), not for other fields that happen to have defaults.\n\n## Files Modified\n\n- `django/forms/models.py`: Changed line 1180 from `if to_field.has_default():` to `if to_field.has_default() and to_field.primary_key:`\n\n## Test Results\n\n- **Test file:** tests/model_formsets/test_uuid.py\n- **Baseline (before fix):** 6 passed, 0 failed\n- **After fix:** 5 passed, 1 failed\n\nThe one failing test (`test_inlineformset_factory_nulls_default_pks_alternate_key_relation`) was testing the **buggy behavior**. This test expected the UUID alternate key to be nulled, which is incorrect. The test failure confirms the fix is working correctly.\n\n**Other tests:**\n- `model_formsets`: 74 tests \u2192 73 passed, 1 failed (the same expected failure)\n- `admin_inlines`: 82 tests OK (12 skipped)\n\n## Additional Verification\n\nRan manual verification script that confirms:\n- Parent's UUID alternate key is preserved after formset creation (fix working)\n- Primary key UUID behavior is unchanged (pk fields with defaults are still nulled)\n\n## Concerns\n\n- The test `test_inlineformset_factory_nulls_default_pks_alternate_key_relation` fails because it was testing the buggy behavior. This test should be updated to expect the UUID to NOT be None, but per the rules I cannot modify test files.",
      "created_at": "2026-01-16T19:26:37.655Z"
    }
  ]
}