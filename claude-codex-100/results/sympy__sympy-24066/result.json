{
  "instance_id": "sympy__sympy-24066",
  "status": "completed",
  "patch": "diff --git a/sympy/physics/units/unitsystem.py b/sympy/physics/units/unitsystem.py\nindex 3daf84c108..23985d7c34 100644\n--- a/sympy/physics/units/unitsystem.py\n+++ b/sympy/physics/units/unitsystem.py\n@@ -192,8 +192,9 @@ def _collect_factor_and_dimension(self, expr):\n         elif isinstance(expr, Function):\n             fds = [self._collect_factor_and_dimension(\n                 arg) for arg in expr.args]\n+            dims = [Dimension(1) if self.get_dimension_system().is_dimensionless(d[1]) else d[1] for d in fds]\n             return (expr.func(*(f[0] for f in fds)),\n-                    *(d[1] for d in fds))\n+                    *dims)\n         elif isinstance(expr, Dimension):\n             return S.One, expr\n         else:\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-15T23:37:58.588445",
  "end_time": "2026-01-15T23:46:20.326879",
  "duration_seconds": 501.738434,
  "error_message": null,
  "workspace_path": "./workspaces/sympy__sympy-24066",
  "epic_comments": [
    {
      "epic_id": "18034419-9047-4422-8413-52d5449e91d0",
      "epic_title": "Fix: sympy__sympy-24066",
      "comment_id": "47743eee-6a6f-4f9f-80d3-e1299b4145a3",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\nFixed the `_collect_factor_and_dimension()` method in `UnitSystem` to properly detect dimensionless arguments in functions like `exp`, `sin`, `cos`, `log`.\n\nThe root cause was that the `Function` case didn't use `is_dimensionless()` to check if argument dimensions are dimensionless before returning. For expressions like `exp(second/(farad*ohm))`, even though `time/(capacitance*impedance)` IS dimensionless, the code returned this dimension directly instead of normalizing it to `Dimension(1)`.\n\nThe fix mirrors the existing pattern in the `Pow` case (line 170-172) which already correctly uses `is_dimensionless()`.\n\n## Files Modified\n- `sympy/physics/units/unitsystem.py`: Modified the `Function` case in `_collect_factor_and_dimension()` to check if argument dimensions are dimensionless using `is_dimensionless()`, and if so, normalize them to `Dimension(1)`.\n\n## Test Results\n- **Test file:** sympy/physics/units/tests/\n- **Baseline (before fix):** 70 passed, 1 expected fail\n- **After fix:** 70 passed, 1 expected fail\n- **Regression check:** No new failures introduced\n\n## Additional Verification\nTested multiple edge cases:\n- `exp(second/(farad*ohm)) + 100` - works correctly, returns `Dimension(1)`\n- `sin(dimensionless)` - works correctly\n- `cos(dimensionless)` - works correctly\n- `log(dimensionless)` - works correctly\n- `exp(meter)` - correctly raises ValueError (non-dimensionless argument)\n\n## Concerns\n- None. The fix is minimal and follows the existing pattern used in the `Pow` case.",
      "created_at": "2026-01-15T22:42:08.120Z"
    },
    {
      "epic_id": "18034419-9047-4422-8413-52d5449e91d0",
      "epic_title": "Fix: sympy__sympy-24066",
      "comment_id": "be058702-720d-44a8-88ae-25cbfc1b43b6",
      "author_name": "Code Reviewer",
      "content": "Code review PASSED.\n\n- Diff is minimal and source-only (`sympy/physics/units/unitsystem.py`).\n- `UnitSystem._collect_factor_and_dimension()` now normalizes dimensionless function-argument dimensions to `Dimension(1)` using `is_dimensionless()`, which fixes the reported `exp(second/(farad*ohm))` case.\n- Quick repro in the container now returns `(E + 100, Dimension(1))` for `100 + exp(second/(ohm*farad))` (no ValueError).",
      "created_at": "2026-01-15T22:46:12.724Z"
    }
  ]
}