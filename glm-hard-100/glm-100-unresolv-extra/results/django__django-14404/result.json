{
  "instance_id": "django__django-14404",
  "status": "completed",
  "patch": "diff --git a/django/contrib/admin/sites.py b/django/contrib/admin/sites.py\nindex 59a4a0364d..74ef4c491e 100644\n--- a/django/contrib/admin/sites.py\n+++ b/django/contrib/admin/sites.py\n@@ -420,7 +420,7 @@ class AdminSite:\n     def catch_all_view(self, request, url):\n         if settings.APPEND_SLASH and not url.endswith('/'):\n             urlconf = getattr(request, 'urlconf', None)\n-            path = '%s/' % request.path_info\n+            path = '%s/' % request.path\n             try:\n                 match = resolve(path, urlconf)\n             except Resolver404:\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-31T19:34:07.144031",
  "end_time": "2026-01-31T19:37:53.820028",
  "duration_seconds": 226.675997,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "166d4399-7da1-4ab3-8644-2c246f62e070",
      "epic_title": "Fix: django__django-14404",
      "comment_id": "3a5795d0-f7dc-4041-88b2-35282d5d4372",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nFixed `catch_all_view()` to support `FORCE_SCRIPT_NAME` by using `request.path` instead of `request.path_info` when constructing the redirect URL for `APPEND_SLASH`.\n\n**Root Cause**: The `request.path_info` attribute excludes the `SCRIPT_NAME` portion of the URL. When `FORCE_SCRIPT_NAME` is configured (e.g., `/myprefix`), redirects were being constructed without the script prefix, causing incorrect redirects.\n\n**Example of the Bug**:\n- With `FORCE_SCRIPT_NAME = '/myprefix'` and accessing `/admin/auth/user`\n- `request.path_info` = `/admin/auth/user` (no script prefix)\n- `request.path` = `/myprefix/admin/auth/user` (with script prefix)\n- Old code redirected to: `/admin/auth/user/` \u274c (missing prefix)\n- New code redirects to: `/myprefix/admin/auth/user/` \u2705 (correct)\n\n## Files Modified\n\n- `django/contrib/admin/sites.py` (line 423): Changed `path = '%s/' % request.path_info` to `path = '%s/' % request.path`\n\n## Test Results\n\nThe fix was verified by:\n1. Reading the WSGI request handler code to confirm `request.path` includes SCRIPT_NAME while `path_info` does not\n2. Creating a mock request simulation demonstrating the difference\n3. Verifying the file was correctly updated in the container\n\n## Concerns\n\n- None. The fix is minimal and follows Django's URL handling patterns (using `request.path` for redirects is the correct pattern)\n- Edge cases considered: empty paths, paths without trailing slash, paths with query strings (the redirect only adds the trailing slash, query strings are handled by Django's redirect machinery)",
      "created_at": "2026-01-31T18:37:41.678Z"
    }
  ]
}