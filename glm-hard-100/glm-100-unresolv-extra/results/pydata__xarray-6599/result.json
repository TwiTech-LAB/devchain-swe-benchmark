{
  "instance_id": "pydata__xarray-6599",
  "status": "completed",
  "patch": "diff --git a/xarray/core/computation.py b/xarray/core/computation.py\nindex 823cbe02..eb7ea4b2 100644\n--- a/xarray/core/computation.py\n+++ b/xarray/core/computation.py\n@@ -1892,6 +1892,7 @@ def polyval(\n     xarray.DataArray.polyfit\n     numpy.polynomial.polynomial.polyval\n     \"\"\"\n+    from .dataarray import DataArray\n \n     if degree_dim not in coeffs._indexes:\n         raise ValueError(\n@@ -1905,6 +1906,19 @@ def polyval(\n     coeffs = coeffs.reindex(\n         {degree_dim: np.arange(max_deg + 1)}, fill_value=0, copy=False\n     )\n+    # Use the dimension coordinate if it exists and BOTH the data and coordinate\n+    # have datetime/timedelta dtypes that are different.\n+    # This preserves the old behavior where polyval would use get_clean_interp_index,\n+    # which extracted the coordinate for datetime-like coordinates.\n+    if (\n+        isinstance(coord, DataArray)\n+        and coord.ndim == 1\n+        and coord.dims[0] in coord.coords\n+        and coord.dtype.kind in \"mM\"\n+        and coord.coords[coord.dims[0]].dtype.kind in \"mM\"\n+        and coord.coords[coord.dims[0]].dtype != coord.dtype\n+    ):\n+        coord = coord.coords[coord.dims[0]]\n     coord = _ensure_numeric(coord)  # type: ignore # https://github.com/python/mypy/issues/1533 ?\n \n     # using Horner's method\n@@ -1934,13 +1948,24 @@ def _ensure_numeric(data: T_Xarray) -> T_Xarray:\n \n     def to_floatable(x: DataArray) -> DataArray:\n         if x.dtype.kind in \"mM\":\n-            return x.copy(\n-                data=datetime_to_numeric(\n-                    x.data,\n-                    offset=np.datetime64(\"1970-01-01\"),\n-                    datetime_unit=\"ns\",\n-                ),\n-            )\n+            if x.dtype.kind == \"m\":\n+                # timedelta64: pass offset=None to use array's minimum as offset\n+                return x.copy(\n+                    data=datetime_to_numeric(\n+                        x.data,\n+                        offset=None,\n+                        datetime_unit=\"ns\",\n+                    ),\n+                )\n+            else:\n+                # datetime64: use a fixed offset for consistency\n+                return x.copy(\n+                    data=datetime_to_numeric(\n+                        x.data,\n+                        offset=np.datetime64(\"1970-01-01\"),\n+                        datetime_unit=\"ns\",\n+                    ),\n+                )\n         return x\n \n     if isinstance(data, Dataset):\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-31T20:19:08.668015",
  "end_time": "2026-01-31T20:28:39.148419",
  "duration_seconds": 570.480404,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": []
}