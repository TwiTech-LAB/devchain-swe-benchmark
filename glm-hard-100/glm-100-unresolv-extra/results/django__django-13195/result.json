{
  "instance_id": "django__django-13195",
  "status": "completed",
  "patch": "diff --git a/django/contrib/messages/storage/cookie.py b/django/contrib/messages/storage/cookie.py\nindex 78256ca3b2..b51e292aa0 100644\n--- a/django/contrib/messages/storage/cookie.py\n+++ b/django/contrib/messages/storage/cookie.py\n@@ -92,7 +92,11 @@ class CookieStorage(BaseStorage):\n                 samesite=settings.SESSION_COOKIE_SAMESITE,\n             )\n         else:\n-            response.delete_cookie(self.cookie_name, domain=settings.SESSION_COOKIE_DOMAIN)\n+            response.delete_cookie(\n+                self.cookie_name,\n+                domain=settings.SESSION_COOKIE_DOMAIN,\n+                samesite=settings.SESSION_COOKIE_SAMESITE,\n+            )\n \n     def _store(self, messages, response, remove_oldest=True, *args, **kwargs):\n         \"\"\"\ndiff --git a/django/http/response.py b/django/http/response.py\nindex e00bcacefb..1b72adb7ae 100644\n--- a/django/http/response.py\n+++ b/django/http/response.py\n@@ -210,13 +210,19 @@ class HttpResponseBase:\n         value = signing.get_cookie_signer(salt=key + salt).sign(value)\n         return self.set_cookie(key, value, **kwargs)\n \n-    def delete_cookie(self, key, path='/', domain=None):\n-        # Most browsers ignore the Set-Cookie header if the cookie name starts\n-        # with __Host- or __Secure- and the cookie doesn't use the secure flag.\n+    def delete_cookie(self, key, path='/', domain=None, samesite=None):\n+        \"\"\"\n+        Delete a cookie.\n+\n+        ``samesite`` should be one of 'lax', 'none', or 'strict'.\n+\n+        Most browsers ignore the Set-Cookie header if the cookie name starts\n+        with __Host- or __Secure- and the cookie doesn't use the secure flag.\n+        \"\"\"\n         secure = key.startswith(('__Secure-', '__Host-'))\n         self.set_cookie(\n             key, max_age=0, path=path, domain=domain, secure=secure,\n-            expires='Thu, 01 Jan 1970 00:00:00 GMT',\n+            expires='Thu, 01 Jan 1970 00:00:00 GMT', samesite=samesite,\n         )\n \n     # Common methods used by subclasses\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-31T18:22:44.089019",
  "end_time": "2026-01-31T18:29:16.989561",
  "duration_seconds": 392.900542,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "9390ee3d-c5a6-4de3-a0e3-39029b5a4049",
      "epic_title": "Fix: django__django-13195",
      "comment_id": "6474bee0-a620-4b53-8035-2eaa0daf0ee2",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nFixed `HttpResponse.delete_cookie()` to preserve the `samesite` attribute when deleting cookies. Previously, when a cookie with `SameSite` set was deleted (via `max_age=0`), the deletion cookie did not include the `samesite` attribute, causing Firefox warnings and potential cookie rejection.\n\n## Files Modified\n\n- **django/http/response.py**: Added `samesite` parameter to `delete_cookie()` method (line 213)\n  - The method now accepts and passes through the `samesite` attribute to `set_cookie()`\n  - Backward compatible - `samesite=None` (default) means no samesite attribute is set\n  - Preserves existing behavior for `__Secure-` and `__Host-` prefixed cookies (auto-sets secure flag)\n\n- **django/contrib/messages/storage/cookie.py**: Updated `_update_cookie()` to pass `samesite` to `delete_cookie()` (line 95)\n  - When deleting the messages cookie, it now properly passes `SESSION_COOKIE_SAMESITE`\n  - This ensures cookie deletion has the same samesite value as when the cookie was set\n\n## Test Results\n\n- **Test file:** tests/responses/test_cookie.py\n- **Baseline (before fix):** All existing tests pass\n- **After fix:** All existing tests still pass (backward compatible)\n- **Manual verification:**\n  - `delete_cookie('test', samesite='Lax')` \u2192 Cookie includes `SameSite=Lax` \u2713\n  - `delete_cookie('test')` \u2192 Cookie without samesite (backward compatible) \u2713\n  - `delete_cookie('__Secure-test', samesite='Lax')` \u2192 Cookie includes both `Secure` and `SameSite=Lax` \u2713\n  - Messages framework deletion now preserves `SESSION_COOKIE_SAMESITE` \u2713\n\n## Edge Cases Handled\n\n- Empty samesite (`None`): Does not set samesite attribute (backward compatible)\n- Different samesite values: 'Lax', 'None', 'Strict' all work correctly\n- Prefixed cookies (`__Secure-`, `__Host-`): Still auto-set secure flag\n- Domain parameter: Preserved and passed through correctly\n\n## Concerns\n\nNone. The fix is minimal, focused, and backward compatible.",
      "created_at": "2026-01-31T17:29:02.687Z"
    }
  ]
}