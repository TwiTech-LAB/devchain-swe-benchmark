{
  "instance_id": "mwaskom__seaborn-3069",
  "status": "completed",
  "patch": "diff --git a/seaborn/_core/plot.py b/seaborn/_core/plot.py\nindex 4f0290a4..f2a5d617 100644\n--- a/seaborn/_core/plot.py\n+++ b/seaborn/_core/plot.py\n@@ -1475,21 +1475,26 @@ class Plotter:\n \n                 axes_df = self._filter_subplot_data(df, view)\n \n-                with pd.option_context(\"mode.use_inf_as_null\", True):\n-                    if keep_na:\n-                        # The simpler thing to do would be x.dropna().reindex(x.index).\n-                        # But that doesn't work with the way that the subset iteration\n-                        # is written below, which assumes data for grouping vars.\n-                        # Matplotlib (usually?) masks nan data, so this should \"work\".\n-                        # Downstream code can also drop these rows, at some speed cost.\n-                        present = axes_df.notna().all(axis=1)\n-                        nulled = {}\n-                        for axis in \"xy\":\n-                            if axis in axes_df:\n-                                nulled[axis] = axes_df[axis].where(present)\n-                        axes_df = axes_df.assign(**nulled)\n-                    else:\n-                        axes_df = axes_df.dropna()\n+                # Handle inf values like null values for grouping\n+                # In pandas >= 2.0, mode.use_inf_as_null was removed\n+                # Replace inf with nan before processing\n+                import math\n+                axes_df = axes_df.replace([math.inf, -math.inf], math.nan)\n+\n+                if keep_na:\n+                    # The simpler thing to do would be x.dropna().reindex(x.index).\n+                    # But that doesn't work with the way that the subset iteration\n+                    # is written below, which assumes data for grouping vars.\n+                    # Matplotlib (usually?) masks nan data, so this should \"work\".\n+                    # Downstream code can also drop these rows, at some speed cost.\n+                    present = axes_df.notna().all(axis=1)\n+                    nulled = {}\n+                    for axis in \"xy\":\n+                        if axis in axes_df:\n+                            nulled[axis] = axes_df[axis].where(present)\n+                    axes_df = axes_df.assign(**nulled)\n+                else:\n+                    axes_df = axes_df.dropna()\n \n                 subplot_keys = {}\n                 for dim in [\"col\", \"row\"]:\n@@ -1627,11 +1632,17 @@ class Plotter:\n \n     def _finalize_figure(self, p: Plot) -> None:\n \n+        from seaborn._core.scales import Nominal\n+\n         for sub in self._subplots:\n             ax = sub[\"ax\"]\n             for axis in \"xy\":\n                 axis_key = sub[axis]\n \n+                # Check if this axis has a Nominal scale\n+                scale = self._scales.get(axis_key)\n+                is_nominal = isinstance(scale, Nominal)\n+\n                 # Axis limits\n                 if axis_key in p._limits:\n                     convert_units = getattr(ax, f\"{axis}axis\").convert_units\n@@ -1643,6 +1654,21 @@ class Plotter:\n                     if isinstance(b, str):\n                         hi = cast(float, hi) + 0.5\n                     ax.set(**{f\"{axis}lim\": (lo, hi)})\n+                elif is_nominal:\n+                    # Nominal scale should behave like categorical axis\n+                    # Set limits to +/- 0.5 from first and last tick\n+                    # (only if user hasn't explicitly set limits)\n+                    n = len(getattr(ax, f\"get_{axis}ticks\")())\n+                    if axis == \"x\":\n+                        ax.set_xlim(-.5, n - .5, auto=None)\n+                    else:\n+                        # Y axis for categorical plots is inverted\n+                        ax.set_ylim(n - .5, -.5, auto=None)\n+\n+                # Nominal scale should behave like categorical axis\n+                # Disable grid for categorical/nominal axis\n+                if is_nominal:\n+                    getattr(ax, f\"{axis}axis\").grid(False)\n \n         engine_default = None if p._target is not None else \"tight\"\n         layout_engine = p._layout_spec.get(\"engine\", engine_default)\ndiff --git a/seaborn/_oldcore.py b/seaborn/_oldcore.py\nindex 192af381..7a43697f 100644\n--- a/seaborn/_oldcore.py\n+++ b/seaborn/_oldcore.py\n@@ -1116,13 +1116,15 @@ class VectorPlotter:\n                 parts = []\n                 grouped = self.plot_data[var].groupby(self.converters[var], sort=False)\n                 for converter, orig in grouped:\n-                    with pd.option_context('mode.use_inf_as_null', True):\n-                        orig = orig.dropna()\n-                        if var in self.var_levels:\n-                            # TODO this should happen in some centralized location\n-                            # it is similar to GH2419, but more complicated because\n-                            # supporting `order` in categorical plots is tricky\n-                            orig = orig[orig.isin(self.var_levels[var])]\n+                    import math\n+                    # Replace inf with nan (mode.use_inf_as_null was removed in pandas 2.0)\n+                    orig = orig.replace([math.inf, -math.inf], math.nan)\n+                    orig = orig.dropna()\n+                    if var in self.var_levels:\n+                        # TODO this should happen in some centralized location\n+                        # it is similar to GH2419, but more complicated because\n+                        # supporting `order` in categorical plots is tricky\n+                        orig = orig[orig.isin(self.var_levels[var])]\n                     comp = pd.to_numeric(converter.convert_units(orig))\n                     if converter.get_scale() == \"log\":\n                         comp = np.log10(comp)\ndiff --git a/seaborn/categorical.py b/seaborn/categorical.py\nindex 3394c9c7..8c2c6daa 100644\n--- a/seaborn/categorical.py\n+++ b/seaborn/categorical.py\n@@ -1790,8 +1790,10 @@ class _LVPlotter(_CategoricalPlotter):\n         vals = np.asarray(vals)\n         # Remove infinite values while handling a 'object' dtype\n         # that can come from pd.Float64Dtype() input\n-        with pd.option_context('mode.use_inf_as_null', True):\n-            vals = vals[~pd.isnull(vals)]\n+        # Note: mode.use_inf_as_null was removed in pandas 2.0\n+        import math\n+        vals = np.asarray(vals, dtype=object)\n+        vals = vals[~np.isin(vals, [math.inf, -math.inf, math.nan])]\n         n = len(vals)\n         p = self.outlier_prop\n \n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-01-31T20:59:36.258175",
  "end_time": "2026-01-31T21:08:58.678603",
  "duration_seconds": 562.420428,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "18150ec5-89a7-4978-9176-91b4d8b06f39",
      "epic_title": "Fix: mwaskom__seaborn-3069",
      "comment_id": "4253df2e-ad2c-45f1-b7ed-0f98d746ccda",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nModified the `_finalize_figure` method in `seaborn/_core/plot.py` to make Nominal scales (including inferred ones) behave like categorical scales. The fix implements the three distinctive behaviors of categorical axes:\n\n1. **Scale padding**: Limits are drawn to +/- 0.5 from the first and last tick\n2. **Grid disabled**: No grid is shown on nominal axes, even when the active style would show one\n3. **Y-axis inversion**: The y-axis is inverted when it has a nominal scale (consistent with categorical plots)\n\n## Files Modified\n\n- **seaborn/_core/plot.py**: \n  - Modified `_finalize_figure` to detect Nominal scales and apply the categorical behaviors\n  - Fixed pandas 2.0 compatibility issue with `mode.use_inf_as_null` (replaced with `math.inf` handling)\n\n- **seaborn/_oldcore.py**: Fixed pandas 2.0 compatibility issue\n\n- **seaborn/categorical.py**: Fixed pandas 2.0 compatibility issue\n\n## Test Results\n\n- **test_plot.py**: 168 passed, 5 xfailed, 6 warnings\n- **test_scales.py**: 82 passed, 1 xfailed, 2 warnings  \n- **test_categorical.py**: 250 passed, 1 skipped (1 pre-existing numpy/pandas deprecation issue unrelated to this fix)\n\n## Verification\n\nManual testing confirms:\n- Nominal x-axis: limits set to (-0.5, n-0.5), grid disabled\n- Nominal y-axis: limits set to (n-0.5, -0.5) inverted, grid disabled\n- Explicit user limits are still respected\n- Grid is always disabled for nominal axes\n\n## Concerns\n\nNone. The fix is minimal and focused on the stated issue. The pandas 2.0 compatibility fixes were necessary to unblock the tests.",
      "created_at": "2026-01-31T20:08:34.471Z"
    }
  ]
}