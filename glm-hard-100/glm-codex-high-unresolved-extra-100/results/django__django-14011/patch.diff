diff --git a/django/core/servers/basehttp.py b/django/core/servers/basehttp.py
index 14dab517c9..897ddf2a73 100644
--- a/django/core/servers/basehttp.py
+++ b/django/core/servers/basehttp.py
@@ -80,6 +80,17 @@ class WSGIServer(simple_server.WSGIServer):
 class ThreadedWSGIServer(socketserver.ThreadingMixIn, WSGIServer):
     """A threaded version of the WSGIServer"""
     daemon_threads = True
+    block_on_close = True
+
+    def process_request_thread(self, request, client_address):
+        """Override to close database connections after handling a request."""
+        try:
+            super().process_request_thread(request, client_address)
+        finally:
+            from django.db import connections
+            from django.db.backends.base.base import BaseDatabaseWrapper
+            for conn in connections.all():
+                BaseDatabaseWrapper.close(conn)
 
 
 class ServerHandler(simple_server.ServerHandler):
diff --git a/django/test/testcases.py b/django/test/testcases.py
index 92f566b7b0..e1668f023b 100644
--- a/django/test/testcases.py
+++ b/django/test/testcases.py
@@ -1511,7 +1511,15 @@ class LiveServerThread(threading.Thread):
             self.error = e
             self.is_ready.set()
         finally:
-            connections.close_all()
+            self._close_connections()
+
+    def _close_connections(self):
+        """Close database connections, including those to in-memory databases."""
+        for conn in connections.all():
+            # Force close for in-memory databases which normally ignore
+            # close requests to prevent data loss.
+            from django.db.backends.base.base import BaseDatabaseWrapper
+            BaseDatabaseWrapper.close(conn)
 
     def _create_server(self):
         return self.server_class(
