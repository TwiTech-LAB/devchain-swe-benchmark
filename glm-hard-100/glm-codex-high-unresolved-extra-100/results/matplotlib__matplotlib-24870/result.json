{
  "instance_id": "matplotlib__matplotlib-24870",
  "status": "completed",
  "patch": "diff --git a/lib/matplotlib/contour.py b/lib/matplotlib/contour.py\nindex 144eadeae2..e1ecc1fd06 100644\n--- a/lib/matplotlib/contour.py\n+++ b/lib/matplotlib/contour.py\n@@ -1123,7 +1123,13 @@ class ContourSet(cm.ScalarMappable, ContourLabeler):\n         \"\"\"\n         if self.levels is None:\n             if len(args) == 0:\n-                levels_arg = 7  # Default, hard-wired.\n+                # For boolean arrays with line contours, default to [0.5]\n+                # instead of 7 levels. Filled contours require at least 2\n+                # levels, so this auto-detection is not applied to them.\n+                if getattr(self, '_bool_contour', False) and not self.filled:\n+                    levels_arg = [0.5]\n+                else:\n+                    levels_arg = 7  # Default, hard-wired.\n             else:\n                 levels_arg = args[0]\n         else:\n@@ -1447,6 +1453,8 @@ class QuadContourSet(ContourSet):\n             fn = 'contour'\n         nargs = len(args)\n         if nargs <= 2:\n+            # Check if input is boolean before conversion\n+            self._bool_contour = np.asarray(args[0]).dtype == np.bool_\n             z = ma.asarray(args[0], dtype=np.float64)\n             x, y = self._initialize_x_y(z)\n             args = args[1:]\n@@ -1475,6 +1483,8 @@ class QuadContourSet(ContourSet):\n \n         x = np.asarray(x, dtype=np.float64)\n         y = np.asarray(y, dtype=np.float64)\n+        # Check if z is boolean before conversion\n+        self._bool_contour = np.asarray(args[2]).dtype == np.bool_\n         z = ma.asarray(args[2], dtype=np.float64)\n \n         if z.ndim != 2:\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-02-03T02:30:57.368538",
  "end_time": "2026-02-03T02:37:59.255274",
  "duration_seconds": 421.886736,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "7e330a60-b43c-40e6-bd1d-5db59cb05660",
      "epic_title": "Fix: matplotlib__matplotlib-24870",
      "comment_id": "830e543a-d5ca-4842-a0b9-c1afb1dad01b",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nImplemented auto-detection of boolean arrays passed to `contour()`. When a boolean 2D array is passed to `plt.contour()` without explicit levels, the function now defaults to a single level at 0.5 (the boundary between True and False regions), instead of generating 8 levels that all cluster at the data boundaries (0 and 1).\n\n## Files Modified\n- `lib/matplotlib/contour.py`:\n  - `_contour_args()`: Added boolean detection for single-argument case (`contour(z)`)\n  - `_check_xyz()`: Added boolean detection for three-argument case (`contour(x, y, z)`)\n  - `_process_contour_level_args()`: Added logic to default levels to [0.5] for boolean arrays with line contours\n\n## Design Decisions\n- **Only applied to line contours (`contour()`)**, not filled contours (`contourf()`). Filled contours require at least 2 levels, so auto-detecting [0.5] would cause an error. Users who want filled contours with boolean data can explicitly specify levels.\n- **Detection happens before type conversion**: Boolean arrays are converted to float64 for processing, so we check the dtype before conversion.\n- **Explicit levels are still respected**: If the user specifies `levels=[...]` or `levels=N`, those are used instead of the auto-detected default.\n\n## Test Results\n- **Test file:** `/testbed/lib/matplotlib/tests/test_contour.py`\n- **Baseline (before fix):** 65 passed, 1 skipped\n- **After fix:** 65 passed, 1 skipped\n- **Regression check:** No new failures introduced\n\n## Additional Verification\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nii, jj = np.ogrid[:100, :100]\nim = (ii+jj) % 20 < 10\n\n# Boolean array without levels \u2192 defaults to [0.5]\ncs = plt.contour(im)\nprint(cs.levels)  # [0.5]\n\n# Explicit levels still work\ncs2 = plt.contour(im, levels=[0.3, 0.7])\nprint(cs2.levels)  # [0.3, 0.7]\n\n# Non-boolean arrays unchanged\ncs3 = plt.contour(im.astype(float))\nprint(len(cs3.levels))  # 8 (default behavior)\n```\n\n## Concerns\n- The `np.bool_` dtype check uses `np.asarray(args[0]).dtype == np.bool_` which should work for standard NumPy boolean arrays. Object arrays or other boolean-like types may not be detected, but this covers the common case described in the issue.",
      "created_at": "2026-02-03T01:36:23.012Z"
    },
    {
      "epic_id": "7e330a60-b43c-40e6-bd1d-5db59cb05660",
      "epic_title": "Fix: matplotlib__matplotlib-24870",
      "comment_id": "53e9bcfa-d3b0-462f-8926-a83c2b191dac",
      "author_name": "Code Reviewer",
      "content": "Code review PASSED.\n\n- Scope is minimal: only `lib/matplotlib/contour.py` changed; no tests/config touched.\n- Logic matches the issue: when `contour()` is called on a boolean `z` with no explicit levels, default levels become `[0.5]` (boundary between False/True), while `contourf()` remains unchanged.\n- Boolean detection is done pre-float conversion and gated via `getattr(self, '_bool_contour', False)` so other paths remain unaffected.",
      "created_at": "2026-02-03T01:37:47.347Z"
    }
  ]
}