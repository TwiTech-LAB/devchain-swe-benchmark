{
  "instance_id": "astropy__astropy-13033",
  "status": "completed",
  "patch": "diff --git a/astropy/timeseries/core.py b/astropy/timeseries/core.py\nindex c279f35f87..689273ae24 100644\n--- a/astropy/timeseries/core.py\n+++ b/astropy/timeseries/core.py\n@@ -74,12 +74,19 @@ class BaseTimeSeries(QTable):\n                                  \"as the first column{} but time series has no columns\"\n                                  .format(self.__class__.__name__, required_columns[0], plural))\n \n-            elif self.colnames[:len(required_columns)] != required_columns:\n-\n+            # Check if the first column is wrong - this gives the most specific error\n+            if len(self.colnames) > 0 and self.colnames[0] != required_columns[0]:\n                 raise ValueError(\"{} object is invalid - expected '{}' \"\n                                  \"as the first column{} but found '{}'\"\n                                  .format(self.__class__.__name__, required_columns[0], plural, self.colnames[0]))\n \n+            # Check if any other required columns (beyond the first) are missing\n+            missing_columns = [col for col in required_columns if col not in self.colnames]\n+            if missing_columns:\n+                missing_str = ', '.join(repr(col) for col in missing_columns)\n+                raise ValueError(\"{} object is invalid - missing required column{}: {}\"\n+                                 .format(self.__class__.__name__, 's' if len(missing_columns) > 1 else '', missing_str))\n+\n             if (self._required_columns_relax\n                     and self._required_columns == self.colnames[:len(self._required_columns)]):\n                 self._required_columns_relax = False\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-02-03T00:41:22.153928",
  "end_time": "2026-02-03T00:48:35.016849",
  "duration_seconds": 432.862921,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "ef3ae318-3b57-4d93-ac1d-b33fd90be494",
      "epic_title": "Fix: astropy__astropy-13033",
      "comment_id": "79ea720d-3b10-45d2-b5f7-7ea0335dd1a3",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nFixed the misleading exception when a required column check fails in TimeSeries. Previously, when a non-first required column (like 'flux') was removed, the error would incorrectly say \"expected 'time' as the first column but found 'time'\" - which was confusing since 'time' WAS the first column.\n\nThe fix adds a check for missing required columns (beyond the first) and provides a clearer error message like \"missing required column: 'flux'\".\n\n## Files Modified\n- `astropy/timeseries/core.py`: Added check for missing required columns with clearer error message\n\n## Test Results\n- **Test file:** `/testbed/astropy/timeseries/tests/test_sampled.py`\n- **Baseline (before fix):** 21 passed, 1 failed, 3 skipped\n- **After fix:** 21 passed, 1 failed, 3 skipped\n- **Regression check:** No new failures introduced\n- **Pre-existing errors:** `test_initialization_with_time_delta` fails due to unrelated IERS/leap-second issue\n\nAlso ran:\n- `test_binned.py`: 23 passed, 1 failed (same pre-existing IERS issue)\n- `test_common.py`: 23 passed, 1 failed (same pre-existing IERS issue)\n\n## Additional Verification\nVerified the fix produces correct error messages:\n- Original issue (removing 'flux' when 'time' and 'flux' are required): \"missing required column: 'flux'\"\n- Removing 'time' (first required column): \"expected 'time' as the first column but found 'flux'\"\n- Adding column at index 0 (wrong first column): \"expected 'time' as the first column but found 'c'\"\n\n## Concerns\nNone. The fix is minimal and handles all edge cases correctly.",
      "created_at": "2026-02-02T23:46:18.366Z"
    },
    {
      "epic_id": "ef3ae318-3b57-4d93-ac1d-b33fd90be494",
      "epic_title": "Fix: astropy__astropy-13033",
      "comment_id": "3712694e-e73c-46ae-8913-d4aec70185c8",
      "author_name": "Code Reviewer",
      "content": "Code review PASSED.\n\n- Change is minimal and confined to `astropy/timeseries/core.py`.\n- Fix directly addresses the reported issue by raising a clear \"missing required column(s)\" ValueError when non-first required columns are absent, while preserving the existing first-column validation behavior.\n- No test files or build configs were modified; reported test failures appear pre-existing/unrelated (IERS/leap-second).",
      "created_at": "2026-02-02T23:48:26.024Z"
    }
  ]
}