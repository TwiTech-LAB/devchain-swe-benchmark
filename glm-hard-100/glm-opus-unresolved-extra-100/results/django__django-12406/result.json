{
  "instance_id": "django__django-12406",
  "status": "completed",
  "patch": "diff --git a/django/forms/models.py b/django/forms/models.py\nindex dafc11f995..104aac3b27 100644\n--- a/django/forms/models.py\n+++ b/django/forms/models.py\n@@ -1185,7 +1185,7 @@ class ModelChoiceField(ChoiceField):\n                  required=True, widget=None, label=None, initial=None,\n                  help_text='', to_field_name=None, limit_choices_to=None,\n                  **kwargs):\n-        if required and (initial is not None):\n+        if required and (initial is not None or (widget is not None and getattr(widget, 'input_type', None) == 'radio')):\n             self.empty_label = None\n         else:\n             self.empty_label = empty_label\n",
  "epics_created": 1,
  "epics_completed": 1,
  "start_time": "2026-02-03T15:28:07.663498",
  "end_time": "2026-02-03T15:38:11.057194",
  "duration_seconds": 603.393696,
  "error_message": null,
  "workspace_path": "<redacted>",
  "epic_comments": [
    {
      "epic_id": "7c7ca113-2c68-4fdd-931b-6891d8d536ff",
      "epic_title": "Fix: django__django-12406",
      "comment_id": "aba7f067-036c-48cd-9caa-3e805a5daff4",
      "author_name": "Brainstormer",
      "content": "## Fix Summary\n\nFixed the issue where RadioSelect widget for foreign keys incorrectly presented a blank option when `blank=False` on the model.\n\n**Root Cause:** In `ModelChoiceField.__init__`, the blank option was only removed when `required=True` AND an `initial` value was set. This meant that required fields with RadioSelect (which has an inherent \"unselected\" state) still showed the confusing blank option.\n\n**Fix:** Modified the condition to also exclude the blank option for RadioSelect widgets when the field is required. Used `getattr(widget, 'input_type', None) == 'radio'` to detect RadioSelect without needing additional imports.\n\n## Files Modified\n- `django/forms/models.py`: Updated `ModelChoiceField.__init__` to check for RadioSelect widget and exclude blank option for required fields\n\n## Test Results\n- **Test files:** `model_forms.test_modelchoicefield`, `forms_tests`\n- **Baseline (before fix):** 22 tests passed (ModelChoiceField), 649 tests passed (forms_tests)\n- **After fix:** 22 tests passed (ModelChoiceField), 649 tests passed (forms_tests)\n- **Regression check:** No new failures introduced\n- **Pre-existing errors:** None\n\n## Additional Verification\nCreated verification script that confirmed:\n1. \u2713 RadioSelect with required=True (blank=False): No blank option (THE FIX)\n2. \u2713 Select widget with required=True: Has blank option (existing behavior preserved)\n3. \u2713 RadioSelect with optional field (blank=True): Has blank option (existing behavior preserved)\n\n## Concerns\n- The fix uses `getattr(widget, 'input_type', None) == 'radio'` which works for RadioSelect and any subclasses that don't override `input_type`\n- This is a minimal change that preserves existing behavior for all other widgets while fixing the RadioSelect issue",
      "created_at": "2026-02-03T14:36:03.372Z"
    },
    {
      "epic_id": "7c7ca113-2c68-4fdd-931b-6891d8d536ff",
      "epic_title": "Fix: django__django-12406",
      "comment_id": "f5c41336-b201-411d-ba44-d850a59f92b0",
      "author_name": "Code Reviewer",
      "content": "Code review PASSED.\n\n**Checklist:**\n- [x] No test files modified \u2014 only `django/forms/models.py` changed\n- [x] No unrelated files modified \u2014 single targeted file\n- [x] Fix logically addresses the problem \u2014 removes blank option for RadioSelect when `required=True` (i.e., `blank=False`)\n- [x] No obvious crash bugs \u2014 `getattr(widget, 'input_type', None)` safely handles edge cases; `widget is not None` guard prevents issues with default widget\n- [x] Changes are minimal and focused \u2014 single-line condition change\n\n**Verification:**\n- Confirmed `RadioSelect.input_type = 'radio'` at `widgets.py:758`\n- Widget flow verified: `Meta.widgets` \u2192 `fields_for_model` \u2192 `ForeignKey.formfield()` \u2192 `ModelChoiceField.__init__()` correctly passes the widget\n- Works for both widget instances (`RadioSelect()`) and classes (`RadioSelect`)\n- Select widget (`input_type = 'select'`) is unaffected, preserving existing blank-option behavior\n- No test regressions (22/22 ModelChoiceField, 649/649 forms_tests)\n\nClean, minimal fix that correctly addresses the problem statement.",
      "created_at": "2026-02-03T14:38:03.489Z"
    }
  ]
}